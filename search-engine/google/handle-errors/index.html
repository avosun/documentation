<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        
        
        <link rel="canonical" href="https://serp-spider.github.io/documentation/search-engine/google/handle-errors/">
        <link rel="shortcut icon" href="../../../../../../favicon.ico">
        

	    <title>Handle Google error - Documentation - The SERP Spider</title>

        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">        <link href="../../../css/base.css" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Inconsolata:400,700' rel='stylesheet' type='text/css'>

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-75620778-1', 'serp-spider.github.io');
            ga('send', 'pageview');
        </script>
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="/"><img alt='SERPS logo' src="../../../images/logo.png">SERPS</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../..">Home</a>
</li>

                        
                            
<li >
    <a href="../../../overview/">Overview</a>
</li>

                        
                            
<li >
    <a href="../../../browser/">Browser</a>
</li>

                        
                            
<li >
    <a href="../../../cookies/">Cookies</a>
</li>

                        
                            
<li >
    <a href="../../../proxy/">Proxies</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Search Engines <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../">Google</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Http Clients <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../http-client/curl/">CURL</a>
</li>

                        
                            
<li >
    <a href="../../../http-client/phantomJS/">PhantomJS</a>
</li>

                        
                            
<li >
    <a href="../../../http-client/spidyJS/">SpidyJS</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../about/packages/">Packages</a>
</li>

                        
                            
<li >
    <a href="../../../about/versions/">Versions</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li>
                        <a href="https://github.com/serp-spider">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">

    <div class="alpha-banner">
        <i class="fa fa-exclamation-circle"></i>
        We just released <a href="/about/migration/from-v0_1-to-v0_2/">version 0.2</a>
        <i class="fa fa-exclamation-circle"></i>
    </div>

    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#handle-erros-from-the-google-client">Handle erros from the google client</a></li>
        
            <li class="level-2"><a href="#request-error">Request error</a></li>
            
                <li class="level-3"><a href="#network-errors">Network errors</a></li>
                    
            
                <li class="level-3"><a href="#invalide-response">Invalide Response</a></li>
                    
            
                <li class="level-3"><a href="#captcha-errors">Captcha errors</a></li>
                    
            
        
            <li class="level-2"><a href="#dom-errors">DOM errors</a></li>
            
        
            <li class="level-2"><a href="#more-complete-example-of-error-handling">More complete example of error handling</a></li>
            
        
    
    </ul>
</div></div>
                <div class="col-md-9" id="main-content" role="main">

<h1 id="handle-erros-from-the-google-client">Handle erros from the google client</h1>
<p></p>

<hr />
<p>Back to the <a href="../"><strong>general google documentation</strong></a>.</p>
<hr />
<p>Working with google involves to make http request, to get an output from google and to parse this output. 
All of these steps are not error free, you can encounter a network error, an error from google server, get a captcha
or even face some updated google serp not supported by your version of the library.</p>
<p>Errors are managed with exceptions, that makes them easy to handle.</p>
<h2 id="request-error">Request error</h2>
<p>There are several reasons for a request error to trigger:</p>
<ul>
<li>A network error</li>
<li>A http error</li>
<li>A captcha error</li>
</ul>
<p>All these errors can be grouped under the same exception type:</p>
<pre><code class="php">    use Serps\SearchEngine\Google\GoogleClient;
    use Serps\HttpClient\CurlClient;
    use Serps\SearchEngine\Google\GoogleUrl;
    use Serps\Exception\RequestError\RequestErrorException;

    $googleClient = new GoogleClient(new CurlClient());

    $googleUrl = new GoogleUrl();
    $googleUrl-&gt;setSearchTerm('simpsons');

    try{
        $response = $googleClient-&gt;query($googleUrl);
    }catch(RequestErrorException $e){
        // Some error with the request
        $errorInfo = $e-&gt;getMessage();
    }
</code></pre>

<p>It's possible to make the distinction between each of them, see bellow.</p>
<h3 id="network-errors">Network errors</h3>
<p>Network errors occur when it was not possible to create a valid http connexion with google. They use to be triggered
by http client, and they can be different for each http client.</p>
<pre><code class="php">    use Serps\SearchEngine\Google\GoogleClient;
    use Serps\HttpClient\CurlClient;
    use Serps\SearchEngine\Google\GoogleUrl;
    use Serps\Exception\RequestError\NetworkErrorException;

    $googleClient = new GoogleClient(new CurlClient());

    $googleUrl = new GoogleUrl();
    $googleUrl-&gt;setSearchTerm('simpsons');

    try{
        $response = $googleClient-&gt;query($googleUrl);
    }catch(NetworkErrorException $e){
        // Something wrong happened with network
        $errorInfo = $e-&gt;getMessage();
    }
</code></pre>

<h3 id="invalide-response">Invalide Response</h3>
<p>A invalid response happens when the http server returned a invalid response (status code 404, 500...).</p>
<pre><code class="php">    use Serps\SearchEngine\Google\GoogleClient;
    use Serps\HttpClient\CurlClient;
    use Serps\SearchEngine\Google\GoogleUrl;
    use Serps\Exception\RequestError\InvalidResponseException;

    $googleClient = new GoogleClient(new CurlClient());

    $googleUrl = new GoogleUrl();
    $googleUrl-&gt;setSearchTerm('simpsons');

    try{
        $response = $googleClient-&gt;query($googleUrl);
    }catch(InvalidResponseException $e){
        // Http response is not valid
        $errorInfo = $e-&gt;getMessage();
    }
</code></pre>

<h3 id="captcha-errors">Captcha errors</h3>
<p>A captcha error happens when the the server asks for a captcha to continue.</p>
<pre><code class="php">    use Serps\SearchEngine\Google\GoogleClient;
    use Serps\HttpClient\CurlClient;
    use Serps\SearchEngine\Google\GoogleUrl;
    use Serps\Exception\RequestError\CaptchaException;

    $googleClient = new GoogleClient(new CurlClient());

    $googleUrl = new GoogleUrl();
    $googleUrl-&gt;setSearchTerm('simpsons');

    try{
        $response = $googleClient-&gt;query($googleUrl);
    }catch(CaptchaException $e){
        // Captcha required
        $errorInfo = $e-&gt;getMessage();
    }
</code></pre>

<h2 id="dom-errors">DOM errors</h2>
<p>Once you got the data from google, you are ready to parse the DOM, but you are not safe against google DOM updates,
Google might have updated its DOM structure and your version of the library is maybe not updated. That's what DOM 
exceptions are made for.</p>
<pre><code class="php">    use Serps\SearchEngine\Google\GoogleClient;
    use Serps\HttpClient\CurlClient;
    use Serps\SearchEngine\Google\GoogleUrl;
    use Serps\SearchEngine\Google\Exception\InvalidDOMException;

    $googleClient = new GoogleClient(new CurlClient());

    $googleUrl = new GoogleUrl();
    $googleUrl-&gt;setSearchTerm('simpsons');

    $response = $googleClient-&gt;query($googleUrl);

    try{
        $results = $response-&gt;getNaturalResults();

        foreach($results as $result){
            // parse results
        }
    }catch(InvalidDOMException $e){
        // Something bad happened while parsing
        // Maybe an update of the library is needed, 
        // the exception message maybe tells more
        $errorInfo = $e-&gt;getMessage();
    }
</code></pre>

<h2 id="more-complete-example-of-error-handling">More complete example of error handling</h2>
<pre><code class="php">    use Serps\SearchEngine\Google\GoogleClient;
    use Serps\HttpClient\CurlClient;
    use Serps\SearchEngine\Google\GoogleUrl;
    use Serps\Exception\RequestError\RequestErrorException;
    use Serps\Exception\RequestError\HttpResponseErrorException;
    use Serps\Exception\RequestError\CaptchaException;
    use Serps\SearchEngine\Google\Exception\InvalidDOMException;

    $googleClient = new GoogleClient(new CurlClient());

    $googleUrl = new GoogleUrl();
    $googleUrl-&gt;setSearchTerm('simpsons');

    $response = null;

    try{
        $response = $googleClient-&gt;query($googleUrl);
    }catch(HttpResponseErrorException $e){
        // Http response is not valid, maybe an error from google or your url
        $errorInfo = $e-&gt;getMessage();
    }catch(CaptchaException $e){
        // Captcha needs to be solved
    }catch(RequestErrorException $e){
        // Other request error are handled here, maybe something wrong with your network
        $errorInfo = $e-&gt;getMessage();
    }

    if($response){
        try{
            $results = $response-&gt;getNaturalResults();
            foreach($results as $result){
                // parse results
            }
        }catch(InvalidDOMException $e){
            // Something bad happened while parsing
            // Maybe an update of the library is needed, 
            // the exception message will tell more about
            $errorInfo = $e-&gt;getMessage();
        }
    }
</code></pre>

<hr />
<p>View also:</p>
<ul>
<li><a href="google/client-configuration.md"><strong>Configure the google client</strong></a></li>
<li><a href="google/google-url.md"><strong>Create urls</strong></a></li>
<li><a href="google/parse-page.md"><strong>Parse a google page</strong></a></li>
</ul></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>


                This is an open-source project built for you with <i style="color:#c24b48;" class="fa fa-heart"></i>
                by <a href="https://github.com/gsouf">Soufiane Ghzal</a> and contributors. <br/> The project is being proudly sponsored by <a href="http://www.mondovo.com" target="_blank">Mondovo.com</a>, which uses this script for their <a href="http://www.mondovo.com/rankings-monitor.php" target="_blank">rank tracking service</a>.
                <br/>
                The documentation is generated with <a href="http://www.mkdocs.org/">MkDocs</a>
            </p>
        </footer>

        <script   src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../..';</script>
        <script data-main="../../../mkdocs/js/search.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js"></script>
        <script src="../../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    <script>
        ((window.gitter = {}).chat = {}).options = {
            room: 'serp-spider/help'
        };
        require.config({
            paths: {
                "sidecar": "https://sidecar.gitter.im/dist/sidecar.v1"
            }
        });
        require( ["sidecar"], function ($) {
                    console.log('sidecar loaded');
                }
        );
    </script>

    </body>
</html>
